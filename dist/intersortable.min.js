"use strict";let E=!1,f=null,v=null,d=null;const m={x:0,y:0};let C={x:0,y:0},H=null,y="above",I=null,S="above",s={},b=null;function R(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function x(t){const e=t.getBoundingClientRect();return{x:e.left+e.width/2,y:e.top+e.height/2}}function V(t,e,r,n,a){t.removeAttribute("data-intersortable-item"),t.classList.add("intersortable-clone"),t.setAttribute("data-intersortable-state","clone"),t.style.position="fixed",t.style.pointerEvents="none",t.style.left=r-a.x+"px",t.style.top=n-a.y+"px",t.style.width=e.offsetWidth+"px",t.style.height=e.offsetHeight+"px",t.style.zIndex="var(--intersortable-clone-z-index, 9999)",t.style.opacity="var(--intersortable-clone-opacity, 1)",t.style.transform="scale(var(--intersortable-clone-scale, 1.05))",t.style.boxShadow="var(--intersortable-clone-shadow, 0 10px 25px rgba(0, 0, 0, 0.3))",t.style.transition="var(--intersortable-clone-transition, none)"}function F(){E=!1,document.body.style.cursor="var(--intersortable-cursor-default, auto)",H=null,I=null,S="above",document.querySelectorAll("[data-intersortable-item]").forEach(e=>{e.classList.remove("intersortable-dragging"),e.removeAttribute("data-intersortable-state"),e.style.pointerEvents="",e.querySelectorAll("[data-drag-handle]").forEach(n=>{n.style.pointerEvents=""}),setTimeout(()=>{e.style.transition="",e.style.transform=""},parseFloat(getComputedStyle(document.documentElement).getPropertyValue("--intersortable-animation-duration")||"250"))})}function z(t,e,r){const n=(s.getContainerId||A)(t),a=e.hasAttribute("data-intersortable-container")?(s.getContainerId||A)(e):(s.getContainerId||A)(e.closest("[data-intersortable-container]")||e);if(s.onDOMStart){const o=(s.getItemId||p)(t);s.onDOMStart({itemId:o,fromContainer:n,toContainer:a})}const i=[];document.querySelectorAll("[data-intersortable-item]").forEach(o=>{o!==t&&i.push({element:o,rect:o.getBoundingClientRect()})});const c=t.getBoundingClientRect();if(t.parentNode&&t.parentNode.removeChild(t),e.hasAttribute("data-intersortable-container"))e.appendChild(t);else{const o=e.parentNode;if(!o)return;if(r==="above")o.insertBefore(t,e);else{const u=e.nextSibling;u?o.insertBefore(t,u):o.appendChild(t)}}if(s.onDOMComplete){const o=P();s.onDOMComplete(o)}if(s.onMove){const o=(s.getItemId||p)(t),u=P(),h=u[a]?.indexOf(o)??-1;s.onMove({itemId:o,fromContainer:n,toContainer:a,newIndex:h,allContainers:u})}const g=t.getBoundingClientRect(),w=c.left-g.left,D=c.top-g.top;(Math.abs(w)>1||Math.abs(D)>1)&&(t.style.transform=`translate(${w}px, ${D}px)`,t.style.transition="none",requestAnimationFrame(()=>{const o=getComputedStyle(document.documentElement).getPropertyValue("--intersortable-animation-duration")||"0.2s",u=getComputedStyle(document.documentElement).getPropertyValue("--intersortable-animation-easing")||"ease-out";t.style.transition=`transform ${o} ${u}`,t.style.transform="translate(0, 0)"})),i.forEach(({element:o,rect:u})=>{const h=o.getBoundingClientRect(),O=u.left-h.left,L=u.top-h.top;(Math.abs(O)>1||Math.abs(L)>1)&&(o.style.transform=`translate(${O}px, ${L}px)`,o.style.transition="none",requestAnimationFrame(()=>{const X=getComputedStyle(document.documentElement).getPropertyValue("--intersortable-displaced-duration")||"0.15s",Y=getComputedStyle(document.documentElement).getPropertyValue("--intersortable-animation-easing")||"ease-out";o.style.transition=`transform ${X} ${Y}`,o.style.transform="translate(0, 0)"}))})}function $(){d&&(C=x(d));const t=document.querySelectorAll("[data-intersortable-item]");let e=null,r=1/0;t.forEach(i=>{const l=x(i),c=R(l,C);c<r&&(r=c,e=i)}),document.querySelectorAll("[data-intersortable-container]").forEach(i=>{if(i.querySelectorAll("[data-intersortable-item]").length===0){const c=x(i),g=R(c,C);g<r&&(r=g,e=i)}});const a=e;if(H=a,a)if(a===f)y="above";else{const i=x(a);y=C.y<=i.y?"above":"below"}a&&f&&a!==f&&(a!==I||y!==S)&&(z(f,a,y),I=a,S=y)}function p(t){return t.dataset.itemId||t.id||""}function A(t){const e=t.closest("[data-intersortable-container]");return e?.dataset.containerId||e?.id||""}function P(){const t=document.querySelectorAll("[data-intersortable-container]"),e={};return t.forEach(r=>{const n=(s.getContainerId||A)(r);if(n){const a=r.querySelectorAll("[data-intersortable-item]");e[n]=Array.from(a).map(i=>(s.getItemId||p)(i)).filter(i=>i)}}),e}function G(){document.querySelectorAll("[data-intersortable-item]").forEach(e=>{q(e)})}function q(t){t.querySelector("[data-drag-handle]")?t.querySelectorAll("[data-drag-handle]").forEach(n=>{n.style.cursor||(n.style.cursor="var(--intersortable-cursor-grab, grab)")}):t.style.cursor||(t.style.cursor="var(--intersortable-cursor-grab, grab)")}function _(t){t.forEach(e=>{e.addedNodes.forEach(r=>{if(r.nodeType===Node.ELEMENT_NODE){const n=r;n.hasAttribute("data-intersortable-item")&&q(n),n.querySelectorAll("[data-intersortable-item]").forEach(l=>{q(l)}),n.hasAttribute("data-drag-handle")&&(n.style.cursor||(n.style.cursor="var(--intersortable-cursor-grab, grab)")),n.querySelectorAll("[data-drag-handle]").forEach(l=>{l.style.cursor||(l.style.cursor="var(--intersortable-cursor-grab, grab)")})}})})}function j(){b&&b.disconnect(),b=new MutationObserver(_),b.observe(document.body,{childList:!0,subtree:!0})}function U(){b&&(b.disconnect(),b=null)}export function initSortable(t={}){s={...t},G(),j(),document.addEventListener("mousedown",B),document.addEventListener("mousemove",M),document.addEventListener("mouseup",N)}function B(t){const e=t.target;let r=null,n=null;if(e.closest("[data-drag-handle]"))r=e.closest("[data-drag-handle]"),n=r.closest("[data-intersortable-item]");else if(n=e.closest("[data-intersortable-item]"),n){if(n.querySelector("[data-drag-handle]"))return;r=n}if(n&&r){if(E=!0,f=n,v=r,s.onDragStart){const l=(s.getItemId||p)(n);s.onDragStart({itemId:l,element:n})}I=null,S="above";const a=n.getBoundingClientRect();m.x=t.clientX-a.left,m.y=t.clientY-a.top,d=n.cloneNode(!0),V(d,n,t.clientX,t.clientY,m),document.body.appendChild(d),$(),n.classList.add("intersortable-dragging"),n.setAttribute("data-intersortable-state","dragging"),n.style.opacity="var(--intersortable-dragging-opacity, 0.4)",document.body.style.cursor="var(--intersortable-cursor-grabbing, grabbing)",r.style.cursor="var(--intersortable-cursor-grabbing, grabbing)",document.querySelectorAll("[data-intersortable-item]").forEach(l=>{l!==n&&(l.style.pointerEvents="none",l.querySelectorAll("[data-drag-handle]").forEach(g=>{g.style.pointerEvents="none"}))}),t.preventDefault()}}function M(t){if(E&&d){const e=t.clientX-m.x,r=t.clientY-m.y;d.style.left=e+"px",d.style.top=r+"px",$()}}function N(t){E&&(s.onDragEnd&&s.onDragEnd(),d&&(d.classList.remove("intersortable-clone"),d.removeAttribute("data-intersortable-state"),document.body.removeChild(d),d=null),f&&(f.style.opacity="1",f.classList.remove("intersortable-dragging"),f.removeAttribute("data-intersortable-state"),f=null),v&&(v.style.cursor="var(--intersortable-cursor-grab, grab)",v=null),F())}export function restoreSortOrder(t){Object.entries(t).forEach(([e,r])=>{const n=document.querySelector(`[data-container-id="${e}"], #${e}`);if(!n)return;const a=new Map;n.querySelectorAll("[data-intersortable-item]").forEach(l=>{const c=(s.getItemId||p)(l);c&&a.set(c,l)}),r.forEach(l=>{const c=a.get(l);c&&n.appendChild(c)})})}export function cleanupSortable(){document.removeEventListener("mousedown",B),document.removeEventListener("mousemove",M),document.removeEventListener("mouseup",N),U()}
//# sourceMappingURL=intersortable.min.js.map

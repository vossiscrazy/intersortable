"use strict";let y=!1,c=null,d=null;const g={x:0,y:0};let p={x:0,y:0},w=null,b="above",h=null,C="above",u={};function q(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function I(t){const e=t.getBoundingClientRect();return{x:e.left+e.width/2,y:e.top+e.height/2}}function Y(t,e,r,n,o){t.removeAttribute("data-intersortable-item"),t.classList.add("intersortable-clone"),t.setAttribute("data-intersortable-state","clone"),t.style.position="fixed",t.style.pointerEvents="none",t.style.left=r-o.x+"px",t.style.top=n-o.y+"px",t.style.width=e.offsetWidth+"px",t.style.height=e.offsetHeight+"px",t.style.zIndex="var(--intersortable-clone-z-index, 9999)",t.style.opacity="var(--intersortable-clone-opacity, 1)",t.style.transform="scale(var(--intersortable-clone-scale, 1.05))",t.style.boxShadow="var(--intersortable-clone-shadow, 0 10px 25px rgba(0, 0, 0, 0.3))",t.style.transition="var(--intersortable-clone-transition, none)"}function H(){y=!1,document.body.style.cursor="var(--intersortable-cursor-default, auto)",w=null,h=null,C="above",document.querySelectorAll("[data-intersortable-item]").forEach(e=>{e.classList.remove("intersortable-dragging"),e.removeAttribute("data-intersortable-state"),setTimeout(()=>{e.style.transition="",e.style.transform=""},parseFloat(getComputedStyle(document.documentElement).getPropertyValue("--intersortable-animation-duration")||"250"))})}function O(t,e,r){const n=[];document.querySelectorAll("[data-intersortable-item]").forEach(s=>{s!==t&&n.push({element:s,rect:s.getBoundingClientRect()})});const a=t.getBoundingClientRect();if(t.parentNode&&t.parentNode.removeChild(t),e.hasAttribute("data-intersortable-container"))e.appendChild(t);else{const s=e.parentNode;if(!s)return;if(r==="above")s.insertBefore(t,e);else{const f=e.nextSibling;f?s.insertBefore(t,f):s.appendChild(t)}}const i=t.getBoundingClientRect(),l=a.left-i.left,m=a.top-i.top;(Math.abs(l)>1||Math.abs(m)>1)&&(t.style.transform=`translate(${l}px, ${m}px)`,t.style.transition="none",requestAnimationFrame(()=>{const s=getComputedStyle(document.documentElement).getPropertyValue("--intersortable-animation-duration")||"0.2s",f=getComputedStyle(document.documentElement).getPropertyValue("--intersortable-animation-easing")||"ease-out";t.style.transition=`transform ${s} ${f}`,t.style.transform="translate(0, 0)"})),n.forEach(({element:s,rect:f})=>{const E=s.getBoundingClientRect(),S=f.left-E.left,A=f.top-E.top;(Math.abs(S)>1||Math.abs(A)>1)&&(s.style.transform=`translate(${S}px, ${A}px)`,s.style.transition="none",requestAnimationFrame(()=>{const D=getComputedStyle(document.documentElement).getPropertyValue("--intersortable-displaced-duration")||"0.15s",X=getComputedStyle(document.documentElement).getPropertyValue("--intersortable-animation-easing")||"ease-out";s.style.transition=`transform ${D} ${X}`,s.style.transform="translate(0, 0)"}))})}function L(){d&&(p=I(d));const t=document.querySelectorAll("[data-intersortable-item]");let e=null,r=1/0;t.forEach(a=>{const i=I(a),l=q(i,p);l<r&&(r=l,e=a)}),document.querySelectorAll("[data-intersortable-container]").forEach(a=>{if(a.querySelectorAll("[data-intersortable-item]").length===0){const l=I(a),m=q(l,p);m<r&&(r=m,e=a)}});const o=e;if(w=o,o)if(o===c)b="above";else{const a=I(o);b=p.y<=a.y?"above":"below"}if(o&&c&&o!==c&&(o!==h||b!==C)){const a=(u.getContainerId||v)(c);if(O(c,o,b),u.onMove){const i=(u.getItemId||x)(c),l=(u.getContainerId||v)(c),m=R(),s=m[l]?.indexOf(i)??-1;i&&a&&l&&u.onMove({itemId:i,fromContainer:a,toContainer:l,newIndex:s,allContainers:m})}h=o,C=b}}function x(t){return t.dataset.itemId||t.id||""}function v(t){const e=t.closest("[data-intersortable-container]");return e?.dataset.containerId||e?.id||""}function R(){const t=document.querySelectorAll("[data-intersortable-container]"),e={};return t.forEach(r=>{const n=(u.getContainerId||v)(r);if(n){const o=r.querySelectorAll("[data-intersortable-item]");e[n]=Array.from(o).map(a=>(u.getItemId||x)(a)).filter(a=>a)}}),e}export function initSortable(t={}){u={...t},document.addEventListener("mousedown",$),document.addEventListener("mousemove",P),document.addEventListener("mouseup",B)}function $(t){const e=t.target;let r=null,n=null;if(e.closest("[data-drag-handle]"))r=e.closest("[data-drag-handle]"),n=r.closest("[data-intersortable-item]");else if(n=e.closest("[data-intersortable-item]"),n){if(n.querySelector("[data-drag-handle]"))return;r=n}if(n&&r){y=!0,c=n,h=null,C="above";const o=n.getBoundingClientRect();g.x=t.clientX-o.left,g.y=t.clientY-o.top,d=n.cloneNode(!0),Y(d,n,t.clientX,t.clientY,g),document.body.appendChild(d),L(),n.classList.add("intersortable-dragging"),n.setAttribute("data-intersortable-state","dragging"),n.style.opacity="var(--intersortable-dragging-opacity, 0.4)",document.body.style.cursor="var(--intersortable-cursor-grabbing, grabbing)",t.preventDefault()}}function P(t){if(y&&d){const e=t.clientX-g.x,r=t.clientY-g.y;d.style.left=e+"px",d.style.top=r+"px",L()}}function B(t){if(y){if(u.onComplete){const e=R();u.onComplete(e)}d&&(d.classList.remove("intersortable-clone"),d.removeAttribute("data-intersortable-state"),document.body.removeChild(d),d=null),c&&(c.style.opacity="1",c.classList.remove("intersortable-dragging"),c.removeAttribute("data-intersortable-state"),c=null),H()}}export function restoreSortOrder(t){Object.entries(t).forEach(([e,r])=>{const n=document.querySelector(`[data-container-id="${e}"], #${e}`);if(!n)return;const o=new Map;n.querySelectorAll("[data-intersortable-item]").forEach(i=>{const l=(u.getItemId||x)(i);l&&o.set(l,i)}),r.forEach(i=>{const l=o.get(i);l&&n.appendChild(l)})})}export function cleanupSortable(){document.removeEventListener("mousedown",$),document.removeEventListener("mousemove",P),document.removeEventListener("mouseup",B)}
//# sourceMappingURL=intersortable.min.js.map

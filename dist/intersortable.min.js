"use strict";let p=!1,c=null,h=null,d=null;const m={x:0,y:0};let v={x:0,y:0},H=null,y="above",E=null,C="above",u={},g=null;function O(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function I(t){const e=t.getBoundingClientRect();return{x:e.left+e.width/2,y:e.top+e.height/2}}function X(t,e,r,n,a){t.removeAttribute("data-intersortable-item"),t.classList.add("intersortable-clone"),t.setAttribute("data-intersortable-state","clone"),t.style.position="fixed",t.style.pointerEvents="none",t.style.left=r-a.x+"px",t.style.top=n-a.y+"px",t.style.width=e.offsetWidth+"px",t.style.height=e.offsetHeight+"px",t.style.zIndex="var(--intersortable-clone-z-index, 9999)",t.style.opacity="var(--intersortable-clone-opacity, 1)",t.style.transform="scale(var(--intersortable-clone-scale, 1.05))",t.style.boxShadow="var(--intersortable-clone-shadow, 0 10px 25px rgba(0, 0, 0, 0.3))",t.style.transition="var(--intersortable-clone-transition, none)"}function Y(){p=!1,document.body.style.cursor="var(--intersortable-cursor-default, auto)",H=null,E=null,C="above",document.querySelectorAll("[data-intersortable-item]").forEach(e=>{e.classList.remove("intersortable-dragging"),e.removeAttribute("data-intersortable-state"),e.style.pointerEvents="",e.querySelectorAll("[data-drag-handle]").forEach(n=>{n.style.pointerEvents=""}),setTimeout(()=>{e.style.transition="",e.style.transform=""},parseFloat(getComputedStyle(document.documentElement).getPropertyValue("--intersortable-animation-duration")||"250"))})}function V(t,e,r){const n=[];document.querySelectorAll("[data-intersortable-item]").forEach(i=>{i!==t&&n.push({element:i,rect:i.getBoundingClientRect()})});const s=t.getBoundingClientRect();if(t.parentNode&&t.parentNode.removeChild(t),e.hasAttribute("data-intersortable-container"))e.appendChild(t);else{const i=e.parentNode;if(!i)return;if(r==="above")i.insertBefore(t,e);else{const b=e.nextSibling;b?i.insertBefore(t,b):i.appendChild(t)}}const o=t.getBoundingClientRect(),l=s.left-o.left,f=s.top-o.top;(Math.abs(l)>1||Math.abs(f)>1)&&(t.style.transform=`translate(${l}px, ${f}px)`,t.style.transition="none",requestAnimationFrame(()=>{const i=getComputedStyle(document.documentElement).getPropertyValue("--intersortable-animation-duration")||"0.2s",b=getComputedStyle(document.documentElement).getPropertyValue("--intersortable-animation-easing")||"ease-out";t.style.transition=`transform ${i} ${b}`,t.style.transform="translate(0, 0)"})),n.forEach(({element:i,rect:b})=>{const q=i.getBoundingClientRect(),w=b.left-q.left,L=b.top-q.top;(Math.abs(w)>1||Math.abs(L)>1)&&(i.style.transform=`translate(${w}px, ${L}px)`,i.style.transition="none",requestAnimationFrame(()=>{const D=getComputedStyle(document.documentElement).getPropertyValue("--intersortable-displaced-duration")||"0.15s",M=getComputedStyle(document.documentElement).getPropertyValue("--intersortable-animation-easing")||"ease-out";i.style.transition=`transform ${D} ${M}`,i.style.transform="translate(0, 0)"}))})}function R(){d&&(v=I(d));const t=document.querySelectorAll("[data-intersortable-item]");let e=null,r=1/0;t.forEach(s=>{const o=I(s),l=O(o,v);l<r&&(r=l,e=s)}),document.querySelectorAll("[data-intersortable-container]").forEach(s=>{if(s.querySelectorAll("[data-intersortable-item]").length===0){const l=I(s),f=O(l,v);f<r&&(r=f,e=s)}});const a=e;if(H=a,a)if(a===c)y="above";else{const s=I(a);y=v.y<=s.y?"above":"below"}if(a&&c&&a!==c&&(a!==E||y!==C)){const s=(u.getContainerId||x)(c);if(V(c,a,y),u.onMove){const o=(u.getItemId||S)(c),l=(u.getContainerId||x)(c),f=$(),i=f[l]?.indexOf(o)??-1;o&&s&&l&&u.onMove({itemId:o,fromContainer:s,toContainer:l,newIndex:i,allContainers:f})}E=a,C=y}}function S(t){return t.dataset.itemId||t.id||""}function x(t){const e=t.closest("[data-intersortable-container]");return e?.dataset.containerId||e?.id||""}function $(){const t=document.querySelectorAll("[data-intersortable-container]"),e={};return t.forEach(r=>{const n=(u.getContainerId||x)(r);if(n){const a=r.querySelectorAll("[data-intersortable-item]");e[n]=Array.from(a).map(s=>(u.getItemId||S)(s)).filter(s=>s)}}),e}function F(){document.querySelectorAll("[data-intersortable-item]").forEach(e=>{A(e)})}function A(t){t.querySelector("[data-drag-handle]")?t.querySelectorAll("[data-drag-handle]").forEach(n=>{n.style.cursor||(n.style.cursor="var(--intersortable-cursor-grab, grab)")}):t.style.cursor||(t.style.cursor="var(--intersortable-cursor-grab, grab)")}function z(t){t.forEach(e=>{e.addedNodes.forEach(r=>{if(r.nodeType===Node.ELEMENT_NODE){const n=r;n.hasAttribute("data-intersortable-item")&&A(n),n.querySelectorAll("[data-intersortable-item]").forEach(o=>{A(o)}),n.hasAttribute("data-drag-handle")&&(n.style.cursor||(n.style.cursor="var(--intersortable-cursor-grab, grab)")),n.querySelectorAll("[data-drag-handle]").forEach(o=>{o.style.cursor||(o.style.cursor="var(--intersortable-cursor-grab, grab)")})}})})}function G(){g&&g.disconnect(),g=new MutationObserver(z),g.observe(document.body,{childList:!0,subtree:!0})}function _(){g&&(g.disconnect(),g=null)}export function initSortable(t={}){u={...t},F(),G(),document.addEventListener("mousedown",P),document.addEventListener("mousemove",B),document.addEventListener("mouseup",N)}function P(t){const e=t.target;let r=null,n=null;if(e.closest("[data-drag-handle]"))r=e.closest("[data-drag-handle]"),n=r.closest("[data-intersortable-item]");else if(n=e.closest("[data-intersortable-item]"),n){if(n.querySelector("[data-drag-handle]"))return;r=n}if(n&&r){p=!0,c=n,h=r,E=null,C="above";const a=n.getBoundingClientRect();m.x=t.clientX-a.left,m.y=t.clientY-a.top,d=n.cloneNode(!0),X(d,n,t.clientX,t.clientY,m),document.body.appendChild(d),R(),n.classList.add("intersortable-dragging"),n.setAttribute("data-intersortable-state","dragging"),n.style.opacity="var(--intersortable-dragging-opacity, 0.4)",document.body.style.cursor="var(--intersortable-cursor-grabbing, grabbing)",r.style.cursor="var(--intersortable-cursor-grabbing, grabbing)",document.querySelectorAll("[data-intersortable-item]").forEach(o=>{o!==n&&(o.style.pointerEvents="none",o.querySelectorAll("[data-drag-handle]").forEach(f=>{f.style.pointerEvents="none"}))}),t.preventDefault()}}function B(t){if(p&&d){const e=t.clientX-m.x,r=t.clientY-m.y;d.style.left=e+"px",d.style.top=r+"px",R()}}function N(t){if(p){if(u.onComplete){const e=$();u.onComplete(e)}d&&(d.classList.remove("intersortable-clone"),d.removeAttribute("data-intersortable-state"),document.body.removeChild(d),d=null),c&&(c.style.opacity="1",c.classList.remove("intersortable-dragging"),c.removeAttribute("data-intersortable-state"),c=null),h&&(h.style.cursor="var(--intersortable-cursor-grab, grab)",h=null),Y()}}export function restoreSortOrder(t){Object.entries(t).forEach(([e,r])=>{const n=document.querySelector(`[data-container-id="${e}"], #${e}`);if(!n)return;const a=new Map;n.querySelectorAll("[data-intersortable-item]").forEach(o=>{const l=(u.getItemId||S)(o);l&&a.set(l,o)}),r.forEach(o=>{const l=a.get(o);l&&n.appendChild(l)})})}export function cleanupSortable(){document.removeEventListener("mousedown",P),document.removeEventListener("mousemove",B),document.removeEventListener("mouseup",N),_()}
//# sourceMappingURL=intersortable.min.js.map

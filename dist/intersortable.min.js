"use strict";let y=!1,c=null,p=null,d=null;const m={x:0,y:0};let h={x:0,y:0},w=null,b="above",v=null,C="above",u={};function L(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function I(t){const e=t.getBoundingClientRect();return{x:e.left+e.width/2,y:e.top+e.height/2}}function Y(t,e,a,n,r){t.removeAttribute("data-intersortable-item"),t.classList.add("intersortable-clone"),t.setAttribute("data-intersortable-state","clone"),t.style.position="fixed",t.style.pointerEvents="none",t.style.left=a-r.x+"px",t.style.top=n-r.y+"px",t.style.width=e.offsetWidth+"px",t.style.height=e.offsetHeight+"px",t.style.zIndex="var(--intersortable-clone-z-index, 9999)",t.style.opacity="var(--intersortable-clone-opacity, 1)",t.style.transform="scale(var(--intersortable-clone-scale, 1.05))",t.style.boxShadow="var(--intersortable-clone-shadow, 0 10px 25px rgba(0, 0, 0, 0.3))",t.style.transition="var(--intersortable-clone-transition, none)"}function O(){y=!1,document.body.style.cursor="var(--intersortable-cursor-default, auto)",w=null,v=null,C="above",document.querySelectorAll("[data-intersortable-item]").forEach(e=>{e.classList.remove("intersortable-dragging"),e.removeAttribute("data-intersortable-state"),e.style.pointerEvents="",e.querySelectorAll("[data-drag-handle]").forEach(n=>{n.style.pointerEvents=""}),setTimeout(()=>{e.style.transition="",e.style.transform=""},parseFloat(getComputedStyle(document.documentElement).getPropertyValue("--intersortable-animation-duration")||"250"))})}function V(t,e,a){const n=[];document.querySelectorAll("[data-intersortable-item]").forEach(i=>{i!==t&&n.push({element:i,rect:i.getBoundingClientRect()})});const o=t.getBoundingClientRect();if(t.parentNode&&t.parentNode.removeChild(t),e.hasAttribute("data-intersortable-container"))e.appendChild(t);else{const i=e.parentNode;if(!i)return;if(a==="above")i.insertBefore(t,e);else{const g=e.nextSibling;g?i.insertBefore(t,g):i.appendChild(t)}}const s=t.getBoundingClientRect(),l=o.left-s.left,f=o.top-s.top;(Math.abs(l)>1||Math.abs(f)>1)&&(t.style.transform=`translate(${l}px, ${f}px)`,t.style.transition="none",requestAnimationFrame(()=>{const i=getComputedStyle(document.documentElement).getPropertyValue("--intersortable-animation-duration")||"0.2s",g=getComputedStyle(document.documentElement).getPropertyValue("--intersortable-animation-easing")||"ease-out";t.style.transition=`transform ${i} ${g}`,t.style.transform="translate(0, 0)"})),n.forEach(({element:i,rect:g})=>{const S=i.getBoundingClientRect(),A=g.left-S.left,q=g.top-S.top;(Math.abs(A)>1||Math.abs(q)>1)&&(i.style.transform=`translate(${A}px, ${q}px)`,i.style.transition="none",requestAnimationFrame(()=>{const D=getComputedStyle(document.documentElement).getPropertyValue("--intersortable-displaced-duration")||"0.15s",X=getComputedStyle(document.documentElement).getPropertyValue("--intersortable-animation-easing")||"ease-out";i.style.transition=`transform ${D} ${X}`,i.style.transform="translate(0, 0)"}))})}function H(){d&&(h=I(d));const t=document.querySelectorAll("[data-intersortable-item]");let e=null,a=1/0;t.forEach(o=>{const s=I(o),l=L(s,h);l<a&&(a=l,e=o)}),document.querySelectorAll("[data-intersortable-container]").forEach(o=>{if(o.querySelectorAll("[data-intersortable-item]").length===0){const l=I(o),f=L(l,h);f<a&&(a=f,e=o)}});const r=e;if(w=r,r)if(r===c)b="above";else{const o=I(r);b=h.y<=o.y?"above":"below"}if(r&&c&&r!==c&&(r!==v||b!==C)){const o=(u.getContainerId||x)(c);if(V(c,r,b),u.onMove){const s=(u.getItemId||E)(c),l=(u.getContainerId||x)(c),f=R(),i=f[l]?.indexOf(s)??-1;s&&o&&l&&u.onMove({itemId:s,fromContainer:o,toContainer:l,newIndex:i,allContainers:f})}v=r,C=b}}function E(t){return t.dataset.itemId||t.id||""}function x(t){const e=t.closest("[data-intersortable-container]");return e?.dataset.containerId||e?.id||""}function R(){const t=document.querySelectorAll("[data-intersortable-container]"),e={};return t.forEach(a=>{const n=(u.getContainerId||x)(a);if(n){const r=a.querySelectorAll("[data-intersortable-item]");e[n]=Array.from(r).map(o=>(u.getItemId||E)(o)).filter(o=>o)}}),e}function N(){document.querySelectorAll("[data-intersortable-item]").forEach(e=>{e.querySelector("[data-drag-handle]")?e.querySelectorAll("[data-drag-handle]").forEach(r=>{r.style.cursor||(r.style.cursor="var(--intersortable-cursor-grab, grab)")}):e.style.cursor||(e.style.cursor="var(--intersortable-cursor-grab, grab)")})}export function initSortable(t={}){u={...t},N(),document.addEventListener("mousedown",$),document.addEventListener("mousemove",P),document.addEventListener("mouseup",B)}function $(t){const e=t.target;let a=null,n=null;if(e.closest("[data-drag-handle]"))a=e.closest("[data-drag-handle]"),n=a.closest("[data-intersortable-item]");else if(n=e.closest("[data-intersortable-item]"),n){if(n.querySelector("[data-drag-handle]"))return;a=n}if(n&&a){y=!0,c=n,p=a,v=null,C="above";const r=n.getBoundingClientRect();m.x=t.clientX-r.left,m.y=t.clientY-r.top,d=n.cloneNode(!0),Y(d,n,t.clientX,t.clientY,m),document.body.appendChild(d),H(),n.classList.add("intersortable-dragging"),n.setAttribute("data-intersortable-state","dragging"),n.style.opacity="var(--intersortable-dragging-opacity, 0.4)",document.body.style.cursor="var(--intersortable-cursor-grabbing, grabbing)",a.style.cursor="var(--intersortable-cursor-grabbing, grabbing)",document.querySelectorAll("[data-intersortable-item]").forEach(s=>{s!==n&&(s.style.pointerEvents="none",s.querySelectorAll("[data-drag-handle]").forEach(f=>{f.style.pointerEvents="none"}))}),t.preventDefault()}}function P(t){if(y&&d){const e=t.clientX-m.x,a=t.clientY-m.y;d.style.left=e+"px",d.style.top=a+"px",H()}}function B(t){if(y){if(u.onComplete){const e=R();u.onComplete(e)}d&&(d.classList.remove("intersortable-clone"),d.removeAttribute("data-intersortable-state"),document.body.removeChild(d),d=null),c&&(c.style.opacity="1",c.classList.remove("intersortable-dragging"),c.removeAttribute("data-intersortable-state"),c=null),p&&(p.style.cursor="var(--intersortable-cursor-grab, grab)",p=null),O()}}export function restoreSortOrder(t){Object.entries(t).forEach(([e,a])=>{const n=document.querySelector(`[data-container-id="${e}"], #${e}`);if(!n)return;const r=new Map;n.querySelectorAll("[data-intersortable-item]").forEach(s=>{const l=(u.getItemId||E)(s);l&&r.set(l,s)}),a.forEach(s=>{const l=r.get(s);l&&n.appendChild(l)})})}export function cleanupSortable(){document.removeEventListener("mousedown",$),document.removeEventListener("mousemove",P),document.removeEventListener("mouseup",B)}
//# sourceMappingURL=intersortable.min.js.map
